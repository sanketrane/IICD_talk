
class: inverse
background-image: url("figures/inverse_bg.png")

<hr>
</br>


```{r echo=FALSE, fig.retina=3, out.width='750'}

knitr::include_graphics("figures/timestamp_paper.png")
```

</br>

???
count: false

class: center, middle

### A good test of a model is its versatility in explaining multiple datasets generated in diverse experimental settings.

<p style="color:navy;">A good test of a model is its versatility in explaining multiple datasets generated in diverse experimental settings.</p>

--

```{r echo=FALSE, fig.retina=3, out.width='750px'}

knitr::include_graphics("figures/ts_strategy1.png")
```

<hr>
---

<hr>

```{r echo=FALSE, fig.retina=3, out.width='65%'}

knitr::include_graphics("figures/tmstmp_data.jpeg")
```

--

</br>

### <u>Need for Hierrarchical modelling:</u>

- **Pooling information among cohorts** while fitting models.

--

- Within cohorts **repeat sampling on individual mice** &mdash; Pooling information among mice.

<hr>

???
- The slope of 'decay curve' informs on the dependence of <strong>net loss rate</strong> (death - division) on cell-age.


- The difference in in slopes of each cohort informs on effects of host age.

</br>

---
### Hierarchical age-structured model
<hr>

No information on cell division in this system </br>
&#8618; We track cell-age in this system using,

.shadedbox2[
$$
\small
\begin{aligned}
\frac{\partial N}{\partial t} + \frac{\partial N}{\partial a} = -\lambda(a) \,\, N(t, a), 
\end{aligned}
$$
]
where, $\small \lambda = \delta - \rho  \quad \rightarrow$ net loss rate.

--

</br>

</br>

We can define the model as,

.shadedbox2[
$$
\small
\begin{aligned}
&y_i \sim \text{Normal}(\mu_i, \sigma) \quad \quad \quad 
\mu_i = f(t_i, N_0, \lambda(a))\\
\\
&\text{where, } N_0 \text{ - the initial counts of timestamped cells at time 0.}\\
\\
&N_0 \sim \text{Normal}(\mu_N, \sigma_N)   \quad \quad \text{... varying intercept between cohorts/animals} \\
&\lambda \sim \text{Normal}(\mu_{\lambda}, \sigma_{\lambda})   \quad \quad \quad \text{... varying slope between cohorts/animals}
\end{aligned}
$$
]

???
Since we have no information on cell division in this system,
ASM reduces down to a 2-dimensional PDE.

- $\small \gamma$ - the rate with which $\small \lambda_0$ varies with cell-age _i.e._ 
$\small \lambda_0 \, e^{-\gamma \,a}$. 


---
<hr>
</br>


```{r echo=FALSE, fig.retina=3}
library(kableExtra)
model_compare <- function(looiclist){
  deltaloo_list <- looiclist - min(looiclist) # delta loo-ic
  akaikewt_numerator <- function(x) exp(-0.5 * x) ## akaike wt
  akaikewt_list <- sapply(deltaloo_list, akaikewt_numerator) * 100/sum(exp(- 0.5 * deltaloo_list))
  export_table <- data.frame('deltaloo' = round(deltaloo_list, 2),
                             'Akaike_wt' = round(akaikewt_list, 2))
  colnames(export_table)[1:2] <-  c(paste0('\u0394', 'LooIC'), 
                                    paste0('Akaike weight ', '\u0025'))
  return(export_table)
}


ts_loolist1 <- c(-79.811369, -6.756027, 234.129347, 236.897557)
ts_table1 <- model_compare(ts_loolist1)
rownames(ts_table1) <- c(paste0("N0: mice and ", '\u03bb', ': cohort'),
                         paste0("N0: mice and ", '\u03bb', ': mice'),
                         paste0("N0: cohort and ", '\u03bb', ': mice'),
                         paste0("N0: mice"))
ts_table1 %>%
  kable(caption = "Comparison of the ASM hierarchical models") %>%
  kable_styling(font_size = 15) %>%
  row_spec(which(ts_table1$Î”LooIC == 0), bold = T, color = "navy", background = "skyblue")

```

--

</br>

```{r echo=FALSE, fig.retina=3, out.width='65%'}

knitr::include_graphics("figures/tmstmp_fit.jpeg")
```

<hr>

---
class: inverse
background-image: url("figures/inverse_bg.png")

<hr>

```{r echo=FALSE, fig.retina=3}

knitr::include_graphics("figures/tmstmp_N0.jpeg")
```

--

.pull-left[
```{r echo=FALSE, fig.retina=3, out.width='250'}

knitr::include_graphics("figures/tmstmp_lambda1.jpeg")
```
]

--

.pull-right[
```{r echo=FALSE, fig.retina=3}

knitr::include_graphics("figures/mouse_wise_4.png")
```
]

<hr>
---

### Summary from the timestamp data
<hr>

- The hierarchical model reveals cohort-specific effects on the net loss rate $\small \lambda$ of naive T cells.

- The major distinction in cohorts is the ** age of the host ** when naive T cells were stamped.</br>
&#8618; Possible host-age effects in naive T cell maintenance?

--

### Whats Next?

- Adopt density-dependence model to fit on the timestamp data.

- Include host-age dependence in ASM and refit on the ontogeny data.


---

class: center, middle

# Thanks!

</br>
</br>
</br>
</br>

The models are coded in `Stan` programming language, are compiled using `CMDSTAN` interface and analysed in R using `Rstan` package.

</br>
</br>
</br>
</br>


Slides created in `html` using [remark.js](https://remarkjs.com) and R packages [**knitr**](http://yihui.name/knitr) and [**xaringan**](https://github.com/yihui/xaringan).

